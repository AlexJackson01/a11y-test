import fs from "fs";
import path from "path";
import { LabelTargets, ReportEntry } from "../types";
import { format } from "date-fns";

export const generateJson = (comments: ReportEntry[]) => {
  const output = {
    date: format(new Date(), "yyyy-MM-dd"),
    issues: comments,
  };

  const reportsDir = path.resolve("./reports");
  fs.mkdirSync(reportsDir, { recursive: true });

  const filename = 'comments.json';
  const filepath = path.join(reportsDir, filename);

  fs.writeFileSync(filepath, JSON.stringify(output, null, 2), "utf-8");
};
