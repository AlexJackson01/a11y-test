import chalk from "chalk";
import { touchableHintError, touchables } from "../../constants";
import { hasProp } from "../hasProp";

export const isTouchable = (tag: string) =>
  touchables.filter((touchable) => !touchable.includes("Button")).includes(tag);

export const auditAccessibilityHints = (
  tag: string,
  attributes: any[],
  path: any,
  filePath: string,
  prComments?: any[]
) => {
  if (!isTouchable(tag) || hasProp("accessibilityHint", attributes))
    return null;

  const line = path.node.loc?.start.line || 0;

  if (prComments && !hasProp("accessibilityHint", attributes)) {
    prComments.push({
      type: "accessibilityHint",
      tag,
      line,
      text: touchableHintError,
      location: filePath,
    });

    console.log(
      chalk.yellow(
        `ðŸŸ¡ ${filePath}: <${tag}> on line ${line} missing accessibilityHint`
      )
    );
  }
};
