import * as t from "@babel/types";
import { toSentenceCase } from "./toSentenceCase";
import { NodePath } from "@babel/traverse";

export const addAccessibilityLabels = (
  path: NodePath<t.JSXElement>,
  labelText: string
): boolean => {
  const isDynamic = /^\{.*\}$/.test(labelText);
  const inferred = isDynamic ? labelText : toSentenceCase(labelText);

  path.node.openingElement.attributes.push({
    type: "JSXAttribute",
    name: t.jsxIdentifier("accessibilityLabel"),
    value: isDynamic
      ? t.jsxExpressionContainer(
          t.identifier(inferred.replace(/[{}]/g, ""))
        )
      : t.stringLiteral(inferred),
  });

  return true;
};
